@defer(when this.location.lat !== 0) {

  <google-map
  id="map"
  width="100%"
  height="100%"
  [mapId]="mapId"
  [center]="location"
  [options]="options">
  @for (m of properties; track m.NOM_PARADA) {
    <map-advanced-marker
      #marker="mapAdvancedMarker"
      [position]="m.posicio"
      (mapClick)="openInfoWindow(marker, infoWindow)" >
    </map-advanced-marker>
    <map-info-window
      #infoWindow="mapInfoWindow">
      <a [routerLink]="['/private/stop', m.CODI_PARADA]">
        <h5>{{m.NOM_PARADA}}</h5>
        <div>Parada n√∫m {{m.CODI_PARADA}}</div>
        @for (line of m.linies; track line) {
          <ion-badge>{{line}}</ion-badge>
        }
      </a>
    </map-info-window>
  }
  </google-map>

} @placeholder {

  <div class="ion-spinner-container">waiting for location...
    <ion-spinner class="ion-spinner"></ion-spinner>
  </div>

}
<!-- @loading(after 100ms; minimum 500ms) {

  <div>loading...</div>
  <ion-spinner></ion-spinner>

} -->

@error {

  <div>ERROR</div>
}


// Renders two lists of stops, one for each direction.
function draw_line_stops(response) {
  var stops = properties(response);

  var anada = document.getElementById('anada');
  anada.innerHTML = "";
  stops.filter(function (stop) {    // Filter by direction
    return stop.SENTIT == "A";
  }).sort(function (stop1, stop2) { // Order
    return stop1.ORDRE - stop2.ORDRE;
  }).forEach(function (stop) {      // Fill the <ul> list
    var li = document.createElement('li');
    li.appendChild(document.createTextNode(stop.NOM_PARADA));
    anada.appendChild(li);
  });

  // Same for the opposite direction
  var tornada = document.getElementById('tornada');
  tornada.innerHTML = "";
  stops.filter(function (stop) {
    return stop.SENTIT == "T";
  }).sort(function (stop1, stop2) {
    return stop1.ORDRE - stop2.ORDRE;
  }).forEach(function (stop) {
    var li = document.createElement('li');
    li.appendChild(document.createTextNode(stop.NOM_PARADA));
    tornada.appendChild(li);
  });
}

// Converts a GeoJSON FeatureCollection structure into a "flat" array of object properties.
// Geometries are discarded.
function properties(featureCollection) {
  var properties = [];
  featureCollection.features.forEach(function (feature) {
    properties.push(feature.properties);
  });
  return properties;
}
